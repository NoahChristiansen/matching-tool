



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0, mkdocs-material-3.0.3">
    
    
      
        <title>Modifying the Webapp - Matching Tool</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#modifying-the-webapp" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Matching Tool" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Matching Tool
              </span>
              <span class="md-header-nav__topic">
                Modifying the Webapp
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Matching Tool" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Matching Tool
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      For Users
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        For Users
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/using/" title="Using the Tool" class="md-nav__link">
      Using the Tool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Schemas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Schemas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/schemas/booking-akaalias-data/" title="Booking AKA/Alias Schema" class="md-nav__link">
      Booking AKA/Alias Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/schemas/booking-charging-data/" title="Booking Charge Schema" class="md-nav__link">
      Booking Charge Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/schemas/booking-data/" title="Booking Schema" class="md-nav__link">
      Booking Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/schemas/by-name-list/" title="By-Name Schema" class="md-nav__link">
      By-Name Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/schemas/case-charge-data/" title="Case Charge Schema" class="md-nav__link">
      Case Charge Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/schemas/hmis-akaalias-data/" title="Homelessness Services AKA/Alias Schema" class="md-nav__link">
      Homelessness Services AKA/Alias Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../users/schemas/hmis-data/" title="Homelessness Service Stays Schema" class="md-nav__link">
      Homelessness Service Stays Schema
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      For Administrators
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        For Administrators
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/install/" title="Installing" class="md-nav__link">
      Installing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/updating/" title="Updating" class="md-nav__link">
      Updating
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/matching/" title="Configuring the Matching Service" class="md-nav__link">
      Configuring the Matching Service
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      For Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        For Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../schemas/" title="Creating or Modifying a Schema" class="md-nav__link">
      Creating or Modifying a Schema
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Modifying the Webapp
      </label>
    
    <a href="./" title="Modifying the Webapp" class="md-nav__link md-nav__link--active">
      Modifying the Webapp
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modifying-the-webapp" title="Modifying the Webapp" class="md-nav__link">
    Modifying the Webapp
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database" title="Database" class="md-nav__link">
    Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend" title="Backend" class="md-nav__link">
    Backend
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frontend" title="Frontend" class="md-nav__link">
    Frontend
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../matching/" title="Modifying the Matching Service" class="md-nav__link">
      Modifying the Matching Service
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#modifying-the-webapp" title="Modifying the Webapp" class="md-nav__link">
    Modifying the Webapp
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database" title="Database" class="md-nav__link">
    Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend" title="Backend" class="md-nav__link">
    Backend
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frontend" title="Frontend" class="md-nav__link">
    Frontend
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Modifying the Webapp</h1>
                
                <h2 id="modifying-the-webapp">Modifying the Webapp<a class="headerlink" href="#modifying-the-webapp" title="Permanent link">&para;</a></h2>
<p>The webapp can be modified for adding new APIs, plots or functionalities that will improve the usability as well as the analysis. This document introduce the tech stacks and design patterns in the matching tool. The web application of this matching tool follows one of the popular and productive tech stacks today, a combination of <a href="https://reactjs.org/">React</a>/<a href="https://github.com/reduxjs/react-redux">Redux</a> for creating UI and consuming APIs as the frontend, <a href="http://flask.pocoo.org/">Python/Flask</a> for providing APIs as the backend, and <a href="https://www.sqlalchemy.org/">SQLAlchemy</a> as the Python Object Relation Map (ORM) to communicate with the <a href="https://www.postgresql.org/">PostgreSQL</a> database. The architecture is shown in the diagram.</p>
<p><img alt="diagram" src="../diagram.png" /></p>
<h3 id="database">Database<a class="headerlink" href="#database" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://www.postgresql.org/">PostgreSQL</a>: An open source object-relational database.</li>
<li><a href="http://alembic.zzzcomputing.com/en/latest/">alembic</a>: A database migrations tool written by the author of <a href="https://www.sqlalchemy.org/">SQLAlchemy</a>.</li>
</ul>
<h3 id="backend">Backend<a class="headerlink" href="#backend" title="Permanent link">&para;</a></h3>
<p>The backend of the matching tool follows the general modern Flask patterns with some variations, and uses the Flask <a href="http://flask.pocoo.org/docs/1.0/blueprints/">Blueprints</a> for better modularization of APIs. A blueprint can be seen as a collection of APIs and can be registered to the application. The template html files go to the <code>/templates</code> and all the static files go to the <code>/static</code>, including css files, icon, and the Javascript bundle.</p>
<pre><code>backend
├── __init__.py
├── app.py
├── apis
    ├── __init__.py
    ├── chart.py
    ├── jobs.py
    ├── upload.py
    └── query.py
├── templates
    ├── _base.html
    └── index.html
├── static
    ├── output.js
    ├── main.css
    ⋮
    └── favicon.ico
├── models.py
├── database.py
├── tasks.py
⋮
└── validations
    └── __init__.py
</code></pre>

<ol>
<li>
<p>Tech stacks</p>
<ul>
<li><a href="http://flask.pocoo.org/">Flask</a>: A python microservice framework. Simple restish APIs that talk json with the client side app.</li>
<li><a href="https://github.com/frictionlessdata/goodtables-py">goodtables</a>: A framework to validate tabular data.</li>
<li><a href="http://python-rq.org/">RQ</a>: A simple Python library for queueing jobs and processing them in the background with workers which uses <a href="https://github.com/andymccurdy/redis-py">Redis</a> as a backend. RQ (or something similar) is necessarily because webapp-triggered processes (validation, matching) can take longer than is viable to do synchronously.</li>
<li><a href="https://www.sqlalchemy.org/">SQLAlchemy</a>: A SQL toolkit and Object Relational Mapper that gives application developers the full power and flexibility of SQL.</li>
<li><a href="https://pandas.pydata.org/">Pandas</a>: A Python data analysis library.</li>
</ul>
</li>
<li>
<p>Details</p>
<ul>
<li>
<p><strong>APIs</strong>: One can modify APIs in <code>matching-tool/webapp/backend/apis</code>  Currently, the backend factors the application into 3 sets of blueprint and a <code>query.py</code> module:
        - <code>query.py</code>: A module provides python functions as interface for querying data from postgres, which use <a href="https://pandas.pydata.org/">pandas</a> intensely for data manipulation.
        - <code>chart.py</code>: Charts related APIs, which provide the information consumed by frontend dashboard.
        - <code>jobs.py</code>: Async-jobs related APIs, which use <a href="http://python-rq.org/">rq</a> for getting information of jobs.
        - <code>upload.py</code>: Upload related APIs, which contains functionalities of async uploading and validation.</p>
</li>
<li>
<p><strong>Validation</strong>: If one wants to change the validation rules for the data schemas, <code>matching-tool/webapp/backend/validation</code> is where to modify the codes. This module uses certain functionalities from <a href="https://github.com/frictionlessdata/goodtables.io">goodtables</a>, a python library that implements validation of tabular data according to a given schema and customizable list of checks.</p>
</li>
<li>
<p><strong>ORM</strong>: The backend uses <a href="http://www.sqlalchemy.org/">SQLAlchemy</a> as the Object Relational Mapper which presents a method of associating user-defined Python classes with database tables, and instances of those classes (objects) with rows in their corresponding tables. The database tables are defined in <code>database.py</code></p>
</li>
<li>
<p><strong>output.js</strong>: It's the Javascript bundle file generated by <code>Webpack</code>.</p>
</li>
</ul>
</li>
</ol>
<h3 id="frontend">Frontend<a class="headerlink" href="#frontend" title="Permanent link">&para;</a></h3>
<p>The frontend of the matching tool is basically implemented with React/Redux patterns and stuctured in a variation of Rails Style known as <strong>module index</strong>. We're organizing the sourcecode content by its type. <code>actions</code>, <code>constants</code>, <code>reducers</code>, and <code>components</code> all have dedicated files, but notice that <code>actions</code>, <code>constants</code> and <code>reducers</code> each also have a similarly-named <code>index.js</code> file. Noted that the details of React/Redux are not covered here, one should check out the official documentations.</p>
<pre><code>frontend
├── actions
    └── index.js
├── components
    ├── app.js
    ├── appbar.js
    ├── timeline.js
    ├── venn.js
    ⋮
    └── upload.js
├── constants
    └── index.js
├── index.js
├── reducers
    └── index.js
⋮
├── store
    └── configureStore.js
└── webpack.config.js
</code></pre>

<ol>
<li>
<p>Tech stacks</p>
<ul>
<li><a href="https://webpack.js.org/">Webpack</a>: A module bundler which takes all module dependencies and generates static assets that represent them.</li>
<li><a href="https://reactjs.org/">React</a>: A Javascript library for building user interface.</li>
<li><a href="https://redux.js.org/">Redux</a>: Redux is a predictable state container for JavaScript apps.</li>
<li><a href="https://ramdajs.com/">Ramda</a>: A Javascript library for functional programming.</li>
<li><a href="https://v0.material-ui.com/#/">Material-UI</a>: React components that implement Google's Material Design.</li>
<li><a href="https://uber.github.io/react-vis/">react-vis</a>: A collection of react components to render common data visualization charts.</li>
<li><a href="https://github.com/benfred/venn.js/">venn.js</a>: A javascript library for laying out area proportional venn and euler diagrams.</li>
</ul>
</li>
<li>
<p>Details</p>
<ul>
<li><strong>React components</strong>: One can modify frontend React components in <code>matching-tool/webapp/frontend/components</code>. React lets you define components as classes or functions which split the UI into independent, reusable pieces, and think about each piece in isolation.</li>
<li><strong>Actions</strong>: In Redux, <a href="https://redux.js.org/basics/actions">Actions</a> are payloads of information that send data from your application to your store which can be found the codes in <code>matching-tool/webapp/frontend/actions</code></li>
<li><strong>Reducers</strong>: In Redux, <a href="https://redux.js.org/basics/reducers">Reducers</a> specify how the application's state changes in response to actions sent to the store which can be found in <code>matching-tool/webapp/frontend/reducers</code></li>
<li><strong>webpack.config.js</strong>: The config tells webpack where to find the Javascript and React files, and where to put the generated Javascript bundle.</li>
</ul>
</li>
</ol>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../schemas/" title="Creating or Modifying a Schema" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Creating or Modifying a Schema
              </span>
            </div>
          </a>
        
        
          <a href="../matching/" title="Modifying the Matching Service" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Modifying the Matching Service
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>